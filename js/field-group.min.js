(function(e){function t(e){var t=e.find('[data-name="toggle-select-ui"]:checked').val();t=="1"?e.find('.acf-field[data-name="ajax"]').show():e.find('.acf-field[data-name="ajax"]').hide()}function n(e){var t=e.find('[data-name="toggle-radio-other"]');if(t.is(":checked"))e.find('.acf-field[data-name="save_other_choice"]').show();else{e.find('.acf-field[data-name="save_other_choice"]').hide();e.find('.acf-field[data-name="save_other_choice"] input').removeAttr("checked")}}function r(t){e.each(["display_format","return_format"],function(e,n){var r=t.find('.acf-field[data-name="'+n+'"] input[type="radio"]:checked'),i=t.find('.acf-field[data-name="'+n+'"] input[type="text"]');r.val()!="other"&&i.val(r.val())})}acf.field_group={$fields:null,$locations:null,$options:null,conditions:{},locations:{},options:{},init:function(){var t=this;this.$fields=e("#acf-field-group-fields");this.$locations=e("#acf-field-group-locations");this.$options=e("#acf-field-group-options");this.$fields.addClass("acf-postbox seamless");this.$locations.addClass("acf-postbox");this.$options.addClass("acf-postbox");acf.validation.active=0;t.sort_fields(this.$fields.find(".acf-field-list:first"));e(document).on("submit","#post",function(){return t.submit()});e(document).on("click","#submitdiv .submitdelete",function(){return t.trash()});this.$fields.on("click",".edit-field",function(n){n.preventDefault();t.edit_field(e(this).closest(".field"))});this.$fields.on("click",".duplicate-field",function(n){n.preventDefault();t.duplicate_field(e(this).closest(".field"))});this.$fields.on("click",".move-field",function(n){n.preventDefault();t.move_field(e(this).closest(".field"))});this.$fields.on("click",".delete-field",function(n){n.preventDefault();t.delete_field(e(this).closest(".field"))});this.$fields.on("click",".acf-add-field",function(n){n.preventDefault();t.add_field(e(this).closest(".acf-field-list-wrap").children(".acf-field-list"))});this.$fields.on("change",'tr[data-name="type"] select',function(){t.change_field_type(e(this))});this.$fields.on("blur",'tr[data-name="label"] input',function(n){t.change_field_label(e(this).closest(".field"))});this.$fields.on("keyup",'tr[data-name="label"] input, tr[data-name="name"] input',function(n){t.render_field(e(this).closest(".field"))});this.$fields.on("change","input, textarea, select",function(n){t.save_field(e(this).closest(".field"))});e(document).on("change",'#adv-settings input[name="show_field_keys"]',function(){e(this).val()=="1"?t.$fields.addClass("show-field-keys"):t.$fields.removeClass("show-field-keys")});acf.add_filter("is_field_ready_for_js",function(e,t){t.parents('.field[data-key="acfcloneindex"]').exists()&&(e=!1);return e},99);this.conditions.init();this.locations.init();this.options.init()},get_field_meta:function(e,t){$input=e.find("> .acf-hidden > .input-"+t);return $input.exists()?$input.val():!1},update_field_meta:function(t,n,r){var i=t.find("> .acf-hidden > .input-"+n);if(!i.exists()){var s=t.find("> .acf-hidden > .input-ID").outerHTML().replace(/ID/g,n);i=e(s);i.val(r);t.find("> .acf-hidden").append(i)}if(i.val()==r)return;i.val(r);if(n=="save")return;this.save_field(t,"meta")},delete_field_meta:function(e,t){var n=e.find("> .acf-hidden > .input-"+t);n.exists()&&n.remove();this.save_field(e,"meta")},save_field:function(e,t){t=t||"settings";var n=this.get_field_meta(e,"save");if(n=="settings")return;if(n==t)return;this.update_field_meta(e,"save",t);acf.do_action("save_field",e,t)},submit:function(){var t=this,n=e("#titlewrap #title");if(!n.val()){if(e("#submitdiv").exists()){e("#submitdiv").find(".disabled").removeClass("disabled");e("#submitdiv").find(".button-disabled").removeClass("button-disabled");e("#submitdiv").find(".button-primary-disabled").removeClass("button-primary-disabled");e("#submitdiv .spinner").hide()}alert(acf._e("title_is_required"));n.focus();return!1}t.$fields.find(".field").each(function(){var n=t.get_field_meta(e(this),"save"),r=t.get_field_meta(e(this),"ID"),i=e(this).hasClass("open");if(r=="acfcloneindex"){e(this).remove();return}i&&t.close_field(e(this));n!="settings"&&(n=="meta"?e(this).children(".field-settings").find('[name^="acf_fields['+r+']"]').remove():e(this).find('[name^="acf_fields['+r+']"]').remove())});return!0},trash:function(){return confirm(acf._e("move_to_trash"))},sort_fields:function(e){e.sortable({connectWith:".acf-field-list",update:function(e,t){var n=t.item;acf.field_group.render_fields();acf.do_action("sortstop",n)},handle:".acf-icon"})},render_fields:function(){var t=this;this.$fields.find(".acf-field-list").each(function(){var n=e(this).children(".field").not('[data-id="acfcloneindex"]');n.each(function(n){t.update_field_meta(e(this),"menu_order",n);e(this).find("> .field-info .li-field_order .acf-icon").html(n+1)});n.exists()?e(this).children(".no-fields-message").hide():e(this).children(".no-fields-message").show()})},render_field:function(e){var t=e.find('tr[data-name="label"]:first input').val(),n=e.find('tr[data-name="name"]:first input').val(),r=e.find('tr[data-name="type"]:first select option:selected').text();e.find("> .field-info .li-field_label strong a").text(t);e.find("> .field-info .li-field_name").text(n);e.find("> .field-info .li-field_type").text(r)},edit_field:function(e){e.hasClass("open")?this.close_field(e):this.open_field(e)},open_field:function(e){if(e.hasClass("open"))return!1;e.addClass("open");acf.do_action("open_field",e);e.children(".field-settings").animate({height:"toggle"},250)},close_field:function(e){if(!e.hasClass("open"))return!1;e.removeClass("open");acf.do_action("close_field",e);e.children(".field-settings").animate({height:"toggle"},250)},wipe_field:function(t){var n=t.attr("data-id"),r=acf.get_uniqid("field_");t.attr("data-key",r);t.attr("data-id",r);this.update_field_meta(t,"ID","");this.update_field_meta(t,"key",r);t.find('[id*="'+n+'"]').each(function(){e(this).attr("id",e(this).attr("id").replace(n,r))});t.find('[name*="'+n+'"]').each(function(){e(this).attr("name",e(this).attr("name").replace(n,r))});t.find("> .field-info .pre-field_key").text(r);t.find(".ui-sortable").removeClass("ui-sortable");acf.do_action("wipe_field",t)},duplicate_field:function(t){t.find("select").each(function(){e(this).attr("data-val",e(this).val())});var n=t.clone(),r=t.closest(".acf-field-list");acf.do_action("remove",n);this.wipe_field(n);t.after(n);n.find("select").each(function(){e(this).val(e(this).attr("data-val")).removeAttr("data-val")});setTimeout(function(){n.find('.field_form input[type="text"]:first').focus()},251);this.render_fields();acf.do_action("append",n);t.hasClass("open")?this.close_field(t):this.open_field(n);var i=n.find('tr[data-name="label"]:first input'),s=n.find('tr[data-name="name"]:first input');i.val(i.val()+" ("+acf._e("copy")+")");s.val(s.val()+"_"+acf._e("copy"));this.save_field(n);this.render_field(n);acf.do_action("duplicate_field",n)},move_field:function(t){var n=this,r={action:"acf/field_group/move_field",nonce:acf.get("nonce"),field_id:this.get_field_meta(t,"ID")},i=!1;r.field_id||(i=!0);this.get_field_meta(t,"save")=="settings"&&(i=!0);t.find(".field").not('[data-id="acfcloneindex"]').each(function(){n.get_field_meta(e(this),"ID")||(i=!0);n.get_field_meta(e(this),"save")=="settings"&&(i=!0)});if(i){alert(acf._e("move_field_warning"));return}acf.open_popup({title:acf._e("move_field"),loading:!0,height:220});e.ajax({url:acf.get("ajaxurl"),data:r,type:"post",dataType:"html",success:function(e){acf.field_group.move_field_confirm(t,e)}})},move_field_confirm:function(t,n){acf.update_popup({content:n});var r={action:"acf/field_group/move_field",nonce:acf.get("nonce"),field_id:this.get_field_meta(t,"ID"),field_group_id:0};e("#acf-move-field-form").on("submit",function(){r.field_group_id=e(this).find("select").val();e.ajax({url:acf.get("ajaxurl"),data:r,type:"post",dataType:"html",success:function(e){acf.update_popup({content:e});acf.field_group.delete_field(t)}});return!1})},delete_field:function(t,n){n=n||!0;var r=this.get_field_meta(t,"ID");if(r=="acfcloneindex")return;r&&e("#input-delete-fields").val(e("#input-delete-fields").val()+"|"+r);acf.do_action("delete_field",t);if(!n)return;var i=this,s=t.closest(".acf-field-list");t.css({height:t.height(),width:t.width(),position:"absolute"});t.wrap('<div class="temp-field-wrap" style="height:'+t.height()+'px"></div>');t.animate({opacity:0},250);var o=0,u=!1;if(s.children(".field").length==1){u=s.children(".no-fields-message");o=u.outerHeight()}t.parent(".temp-field-wrap").animate({height:o},250,function(){u&&u.show();acf.do_action("remove",e(this));e(this).remove();i.render_fields()})},add_field:function(e){var t=e.children('.field[data-key="acfcloneindex"]').clone();this.wipe_field(t);t.show();e.children('.field[data-key="acfcloneindex"]').before(t);e.children(".no-fields-message").hide();t.find('.field-settings input[type="text"]').val("");setTimeout(function(){t.find('.field_form input[type="text"]:first').focus()},251);this.render_fields();acf.do_action("append",t);this.edit_field(t);acf.do_action("add_field",t)},change_field_type:function(t){var n=t.closest("tbody"),r=n.closest(".field"),i=r.attr("data-type"),s=t.val();r.removeClass("field_type-"+i).addClass("field_type-"+s).attr("data-type",s);(s=="tab"||s=="message")&&n.find('tr[data-name="name"] input').val("").trigger("keyup");n.children("tr[data-setting]").hide().find("[name]").attr("disabled","true");this.render_field(t.closest(".field"));if(n.children('tr[data-setting="'+s+'"]').exists()){n.children('tr[data-setting="'+s+'"]').show().find("[name]").removeAttr("disabled");acf.do_action("change_field_type",r);return}var o=e('<tr class="acf-field"><td class="acf-label"></td><td class="acf-input"><div class="acf-loading"></div></td></tr>');n.children('.acf-field[data-name="conditional_logic"]').before(o);var u={action:"acf/field_group/render_field_settings",nonce:acf.o.nonce,post_id:acf.o.post_id,prefix:t.attr("name").replace("[type]",""),type:s};e.ajax({url:acf.o.ajaxurl,data:u,type:"post",dataType:"html",success:function(t){if(!t){o.remove();return}var n=e(t);o.replaceWith(n);acf.do_action("append",n);acf.do_action("change_field_type",r)}})},change_field_label:function(t){var n=t.find('tr[data-name="label"]:first input'),r=t.find('tr[data-name="name"]:first input'),i=t.attr("data-type");if(i=="tab"||i=="message"){r.val("").trigger("change");return}if(r.val()==""){var s=n.val(),o={"ä":"a","æ":"a","å":"a","ö":"o","ø":"o","é":"e","ë":"e","ü":"u","ó":"o","ő":"o","ú":"u","é":"e","á":"a","ű":"u","í":"i"," ":"_","'":"","\\?":""};e.each(o,function(e,t){var n=new RegExp(e,"g");s=s.replace(n,t)});s=s.toLowerCase();r.val(s).trigger("change")}this.render_field(t);acf.do_action("change_field_label",t)}};acf.field_group.conditions={$el:null,init:function(){this.$el=acf.field_group.$fields;var t=this;acf.add_action("open_field",function(e){t.render(e)});acf.add_action("change_field_label change_field_type",function(n){t.$el.find(".field.open").each(function(){t.render(e(this))})});t.$el.on("change",'tr[data-name="conditional_logic"] input[type="radio"]',function(n){n.preventDefault();t.change_toggle(e(this))});t.$el.on("change",".conditional-logic-field",function(n){n.preventDefault();t.change_trigger(e(this))});t.$el.on("click",".location-add-rule",function(n){n.preventDefault();t.add_rule(e(this).closest("tr"))});t.$el.on("click",".location-remove-rule",function(n){n.preventDefault();t.remove_rule(e(this).closest("tr"))});t.$el.on("click",".location-add-group",function(n){n.preventDefault();t.add_group(e(this).closest(".location-groups"))})},update_select:function(t,n){var r=t.val();t.html("");e.each(n,function(n,r){var i=t;if(r.group){i=t.find('optgroup[label="'+r.group+'"]');if(!i.exists()){i=e('<optgroup label="'+r.group+'"></optgroup>');t.append(i)}}i.append('<option value="'+r.value+'">'+r.label+"</option>")});t.find('option[value="'+r+'"]').exists()&&t.val(r)},render:function(t){var n=this,r=[],i=t.attr("data-key"),s=t.parents(".acf-field-list"),o=t.find('> .field-settings > table > tbody > tr[data-name="conditional_logic"]');e.each(s,function(t){var n=t==0?acf.l10n.sibling_fields:acf.l10n.parent_fields;e(this).children(".field").each(function(){var t=e(this),s=t.attr("data-key"),o=t.attr("data-type"),u=t.find('> .field-settings > table > tbody > tr[data-name="label"] input').val();if(s=="acfcloneindex")return;if(s==i)return;(o=="select"||o=="checkbox"||o=="true_false"||o=="radio")&&r.push({value:s,label:u,group:n})})});r.length==0&&r.push({value:"null",label:acf.l10n.no_fields});o.find(".conditional-logic-field").each(function(){n.update_select(e(this),r);n.change_trigger(e(this))})},change_toggle:function(e){var t=e.val(),n=e.closest(".acf-input");if(t=="1"){n.find(".location-groups").show();n.find(".location-groups").find("[name]").removeAttr("disabled")}else{n.find(".location-groups").hide();n.find(".location-groups").find("[name]").attr("disabled","disabled")}},change_trigger:function(t){var n=t.val(),r=this.$el.find('.field[data-key="'+n+'"]'),i=r.attr("data-type"),s=t.closest("tr").find(".conditional-logic-value"),o=[];if(i=="true_false")o=[{value:1,label:acf.l10n.checked}];else if(i=="select"||i=="checkbox"||i=="radio"){var u=r.find('tr[data-name="choices"] textarea').val().split("\n");if(u)for(var a=0;a<u.length;a++){var f=u[a].split(":"),l=f[0];f[1]&&(l=f[1]);o.push({value:e.trim(f[0]),label:e.trim(l)})}}this.update_select(s,o)},add_rule:function(t){var n=t.clone(),r=n.attr("data-id"),i=acf.get_uniqid();n.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(r,i));e(this).attr("id",e(this).attr("id").replace(r,i))});n.attr("data-id",i);t.after(n);acf.field_group.save_field(t.closest(".field"))},remove_rule:function(e){var t=e.siblings("tr").length;acf.field_group.save_field(e.closest(".field"));t==0?this.remove_group(e.closest(".location-group")):e.remove()},add_group:function(t){var n=t.find(".location-group:last"),r=n.clone(),i=r.attr("data-id"),s=acf.get_uniqid();r.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(i,s));e(this).attr("id",e(this).attr("id").replace(i,s))});r.attr("data-id",s);r.find("h4").text(acf.l10n.or);r.find("tr:not(:first)").remove();n.after(r)},remove_group:function(e){e.remove()}};acf.field_group.locations={$el:null,init:function(){this.$el=acf.field_group.$locations;var t=this;t.$el.on("click",".location-add-rule",function(n){n.preventDefault();t.add_rule(e(this).closest("tr"))});t.$el.on("click",".location-remove-rule",function(n){n.preventDefault();t.remove_rule(e(this).closest("tr"))});t.$el.on("click",".location-add-group",function(e){e.preventDefault();t.add_group()});t.$el.on("change",".param select",function(){t.change_rule(e(this))})},add_rule:function(t){var n=t.clone(),r=n.attr("data-id"),i=acf.get_uniqid();n.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(r,i));e(this).attr("id",e(this).attr("id").replace(r,i))});n.attr("data-id",i);t.after(n);return!1},remove_rule:function(e){var t=e.siblings("tr").length;t==0?this.remove_group(e.closest(".location-group")):e.remove()},add_group:function(){var t=this.$el.find(".location-group:last"),n=t.clone(),r=n.attr("data-id"),i=acf.get_uniqid();n.find("[name]").each(function(){e(this).attr("name",e(this).attr("name").replace(r,i));e(this).attr("id",e(this).attr("id").replace(r,i))});n.attr("data-id",i);n.find("h4").text(acf.l10n.or);n.find("tr:not(:first)").remove();t.after(n)},remove_group:function(e){e.remove()},change_rule:function(t){var n=t.closest("tr"),r=n.attr("data-id"),i=n.closest(".location-group"),s=i.attr("data-id"),o=e('<div class="acf-loading"></div>');n.find("td.value").html(o);e.ajax({url:acf.get("ajaxurl"),data:acf.prepare_for_ajax({action:"acf/field_group/render_location_value",rule_id:r,group_id:s,value:"",param:t.val()}),type:"post",dataType:"html",success:function(e){o.replaceWith(e)}})}};acf.field_group.options={$el:null,init:function(){this.$el=acf.field_group.$options;var t=this.$el.find('tr[data-name="hide_on_screen"] ul'),n=e('<li><label><input type="checkbox" value="" name="" >'+acf._e("hide_show_all")+"</label></li>");t.find("input:not(:checked)").length==0&&n.find("input").attr("checked","checked");n.on("change","input",function(){var n=e(this).is(":checked");t.find("input").attr("checked",n)});t.prepend(n)}};acf.add_action("ready",function(){acf.field_group.init()});acf.add_action("open_field change_field_type",function(e){if(e.attr("data-type")!="select")return;e.find('.acf-field[data-name="ui"] input[type="radio"]').attr("data-name","toggle-select-ui");t(e)});e(document).on("change",'[data-name="toggle-select-ui"]',function(){t(e(this).closest(".field"))});acf.add_action("open_field change_field_type",function(e){if(e.attr("data-type")!="radio")return;e.find('.acf-field[data-name="other_choice"] input[type="checkbox"]').attr("data-name","toggle-radio-other");n(e)});e(document).on("change",'[data-name="toggle-radio-other"]',function(){n(e(this).closest(".field"))});acf.add_action("open_field change_field_type",function(e){if(e.attr("data-type")!="google_map")return;$lat=e.find('tr[data-name="center_lat"]');$lng=e.find('tr[data-name="center_lng"]');tmpl='<ul class="acf-hl"><li style="width:48%;">$lat</li><li style="width:48%; margin-left:4%;">$lng</li></ul>';if(!$lng.exists())return;tmpl=tmpl.replace("$lat",$lat.find(".acf-input").html());tmpl=tmpl.replace("$lng",$lng.find(".acf-input").html());$lat.find(".acf-input").html(tmpl);$lng.remove()});acf.add_action("open_field change_field_type",function(e){if(e.attr("data-type")!="oembed")return;$width=e.find('tr[data-name="width"]');$height=e.find('tr[data-name="height"]');tmpl='<ul class="acf-hl"><li style="width:48%;">$width</li><li style="width:48%; margin-left:4%;">$height</li></ul>';if(!$width.exists())return;tmpl=tmpl.replace("$width",$width.find(".acf-input").html());tmpl=tmpl.replace("$height",$height.find(".acf-input").html());$width.find(".acf-input").html(tmpl);$height.remove()});acf.add_action("open_field change_field_type",function(e){if(e.attr("data-type")!="date_picker")return;r(e)});e(document).on("change",'.field[data-type="date_picker"] input[type="radio"]',function(){r(e(this).closest(".field"))})})(jQuery);